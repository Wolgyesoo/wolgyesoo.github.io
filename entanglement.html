<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Circle Grid</title>
  <style>
    .circle {
      display: inline-block;
	  width: 20px;
      height: 20px;
      text-align: center;
	  font-size: 15px;
      line-height: 20px;
	  color: gray;
	  margin: 0 auto;
	  vertical-align: top;
    }
    .row {
      white-space: nowrap;
	  height: 20px;
    }
	#container{
	  text-align: center;
	  background: black;
	  width: 400px;
	  height: 200px;
	  margin: 0 auto;
	}
	#score{
	  text-align: center;
	  font-size: 24px;
	  color: gold;
	  background: black;
	  width: 400px;
	  height: 40px;
	  margin: 0 auto;
	}
  </style>
</head>
<body>
  <div id="container"></div>
  <div id="score">score: 0</div>

  <script>
    const rows = 10;
    const cols = 20;
    const container = document.getElementById('container');

    for (let r = 1; r <= rows; r++) {
      const rowDiv = document.createElement('div');
      rowDiv.classList.add('row');

      for (let c = 1; c <= cols; c++) {
        const span = document.createElement('span');
        span.textContent = '●';
        span.className = `circle r${r}c${c}`;
        rowDiv.appendChild(span);
      }

      container.appendChild(rowDiv);
    }
	
	function start(){
	  snake1 = [[8,14],[8,13]];
	  direction1 = 1;
	  gameover1 = false;
	
	  snake2 = [[8,6],[8,7]];
	  direction2 = 1;
	  gameover2 = false;
	  f = 1;
	  
	  food1 = null;
	  qwopidn = 0;
	  
	  spawnFood();
	  
	  for (let r = 1; r <= rows; r++) {
	    for (let c = 1; c <= cols; c++) {
		  document.getElementsByClassName(`r${r}c${c}`)[0].style.color = 'gray';
		  document.getElementById('score').innerText = 'score: 0';
	    }
	  }
	}
	
	const owingpqnv = 35;
	
	frame = 0;
	
	function contains(array, target) {
      return array.some(pos => pos[0] === target[0] && pos[1] === target[1]);
    }
	
	function spawnFood() {
	  while (true) {
		const r = Math.floor(Math.random() * rows) + 1;
		const c = Math.floor(Math.random() * cols) + 1;
		const candidate = [r, c];
		if (!contains(snake1, candidate) && !contains(snake2, candidate)) {
		  food1 = candidate;
		  break;
		}
	  }
	}
	
	function step(){
	  frame++;
	  if(!gameover1){
		last1 = snake1[snake1.length-1];
		let next;
        switch (direction1) {
          case 0: next = [last1[0], last1[1] + 1]; break;
          case 1: next = [last1[0] - 1, last1[1]]; break;
          case 2: next = [last1[0], last1[1] - 1]; break;
          case 3: next = [last1[0] + 1, last1[1]]; break;
        }
		if (contains(snake1, next) || contains(snake2, next) || next[0] < 1 || next[0] > 10 || next[1] < 1 || next[1] > 20) {
		  gameover1 = true;
		  if(gameover1 && gameover2 && qwopidn >= owingpqnv){
		    alert("Congratulations. Type 'Ambidexter' to proceed.");
		  }
		} else {
		  snake1.push(next);

		  if (food1 && next[0] === food1[0] && next[1] === food1[1] && f == 1) {
			food1 = null;
			f = 2;
			spawnFood();
			qwopidn++;
			document.getElementById('score').innerText = 'score: ' + qwopidn;
		  } else {
			const tail = snake1.shift();
			document.getElementsByClassName(`r${tail[0]}c${tail[1]}`)[0].style.color = 'gray';
		  }
		}
	  }
	  if(!gameover2){
		last2 = snake2[snake2.length-1];
		let next;
        switch (direction2) {
          case 0: next = [last2[0], last2[1] + 1]; break;
          case 1: next = [last2[0] - 1, last2[1]]; break;
          case 2: next = [last2[0], last2[1] - 1]; break;
          case 3: next = [last2[0] + 1, last2[1]]; break;
        }
		if (contains(snake1, next) || contains(snake2, next) || next[0] < 1 || next[0] > 10 || next[1] < 1 || next[1] > 20) {
		  gameover2 = true;
		  if(gameover1 && gameover2 && qwopidn >= owingpqnv){
		    alert("Congratulations. Type 'Ambidexter' to proceed.");
		  }
		} else {
		  snake2.push(next);

		  if (food1 && next[0] === food1[0] && next[1] === food1[1] && f == 2) {
			food1 = null;
			f = 1;
			spawnFood();
			qwopidn++;
			document.getElementById('score').innerText = 'score: ' + qwopidn;
		  } else {
			const tail = snake2.shift();
			document.getElementsByClassName(`r${tail[0]}c${tail[1]}`)[0].style.color = 'gray';
		  }
		}
	  }	  
	  if(f==1)
		document.getElementsByClassName(`r${food1[0]}c${food1[1]}`)[0].style.color = 'magenta';
	  else
	    document.getElementsByClassName(`r${food1[0]}c${food1[1]}`)[0].style.color = 'cyan';
	  
	  for(i in snake1){
	    if(gameover1 && frame%4 <= 1)
		  document.getElementsByClassName(`r${snake1[i][0]}c${snake1[i][1]}`)[0].style.color='gray';
		else
	      document.getElementsByClassName(`r${snake1[i][0]}c${snake1[i][1]}`)[0].style.color='red';
	  }
	  for(i in snake2){
	    if(gameover2 && frame%4 <= 1)
		  document.getElementsByClassName(`r${snake2[i][0]}c${snake2[i][1]}`)[0].style.color='gray';
		else
	      document.getElementsByClassName(`r${snake2[i][0]}c${snake2[i][1]}`)[0].style.color='lime';
	  }
	}
	
	document.addEventListener('keydown', function (event) {
      if (event.key === 'ArrowLeft') {
        direction1 = (direction1 + 1) % 4;
      } else if (event.key === 'ArrowRight') {
        direction1 = (direction1 + 3) % 4;
      }
	  if (event.key === 'a') {
        direction2 = (direction2 + 1) % 4;
      } else if (event.key === 'd') {
        direction2 = (direction2 + 3) % 4;
      }
	  if (event.key === 'r') {
	    start();
	  }
    });
	
	start();
	setInterval(step, 250);
  </script>
</body>
</html>